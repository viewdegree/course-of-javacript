<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title></title>
		<style type="text/css">
			#table{
				margin: auto;
				transform: translateX(50px);
			}
			tr,td,th{
				width: 200px;
			}
		</style>
	</head>
	<body>
		<table border="1" cellspacing="0" cellpadding="0" id="table">
			<tr>
				<th>id</th>
				<th>曲名</th>
				<th>作者</th>
			</tr>
		</table>
		 <script type="text/javascript">
		 // 	ajax({
			// 	url: 'http://baidu.com',
			// 	method: 'GET',
			// 	data: {
			// 		"name": 'viewdegree',
			// 		"age": 18
			// 	},
			// 	success: function(data){
			// 		console.log(data)//服务器返回响应信息
			// 	},
			// 	error: function(state){
			// 		console.log(data)//服务器返回状态信息
			// 	} 
			// })
			ajax({
				method : 'GET', 
				url : 'https://api.wulv5.com/music/search',
				data : {
					keywords : '坂本龙一'
				},
				success : function(msg){
					var table = document.getElementById("table");
					var song = msg.result.songs;
					var f = document.createDocumentFragment();//文档碎片
					song.forEach(function(v){
						let tr = document.createElement('tr');
						let td1 = document.createElement('td');
						td1.innerHTML = v.id;
						let td2 = document.createElement('td');
						td2.innerHTML = v.name;
						let td3 = document.createElement('td');
						td3.innerHTML = v.artists.map(function(n){
							return n.name;
						});
						tr.appendChild(td1)
						tr.appendChild(td2)
						tr.appendChild(td3)
						f.appendChild(tr)
					});
					table.appendChild(f);
				},
				error : function(err){
					console.log(err)
				}
			})
			
			function ajax(json){
				if(json.url===undefined){
					return;
				}
				var url = json.url;
				var method = json.method.toUpperCase()||'GET';
				var data = json.data||{};
				var xhr = new XMLHttpRequest;
				function jsonUrl(data){
					var arr = [];
					for(var key in data){
						arr.push(key+'='+data[key])
					}
					return arr.join('&');
				}
				switch(method){
					case 'GET':
						xhr.open('GET',url+'?'+jsonUrl(data),true);
						xhr.send(null);
						break;
					case 'POST':
						xhr.open('POST',url,true);
						xhr.setRequestHeader('content-type','application/x-www-form-urlencoded');
						xhr.send(jsonUrl(data));
						break;
				}
				xhr.onreadystatechange = function(){
					if(xhr.readyState === 4){//表示数据完全接受完毕
						if(xhr.status>=200&&xhr.status<=300||xhr.status===304){//表示返回页面的状态是正常页面
							json.success(JSON.parse(xhr.responseText));//json序列化,将字符串转化为对象
						}else{
							json.error(xhr.status);
						}
					}
				}
			}
		 </script>
	</body>
</html>